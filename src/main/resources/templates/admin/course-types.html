<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Course Types</title>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" th:href="@{/css/navbar.css}">
</head>
<body>
<!-- HEADER -->
<div th:replace="fragments/header :: header"></div>

<!-- NAVBAR -->
<div th:replace="fragments/navbar :: navbar"></div>

<div class="container mt-3">
    <div class="d-flex align-items-center mb-4">
        <h2 class="me-3 mb-0">Course Types</h2>

        <div th:if="${error}"
             class="alert alert-danger alert-dismissible fade show mb-0"
             role="alert"
             id="flashMessage">
            <span th:text="${error}"></span>
            <button type="button"
                    class="btn-close"
                    data-bs-dismiss="alert"
                    aria-label="Close"></button>
        </div>
    </div>

    <table class="table table-bordered">
        <thead>
        <tr>
            <th>Course Type Code</th>
            <th>Name</th>
            <th>Description</th>
            <th>Min Courses</th>
            <th>Max Courses</th>
            <th>Min Credits</th>
            <th>Max Credits</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="ct : ${courseTypes}">
            <td th:text="${ct.ctpcode}">CTP</td>
            <td th:text="${ct.ctpname}">Name</td>
            <td th:text="${ct.ctpdesc}">Description</td>
            <td th:text="${ct.minCourses}">0</td>
            <td th:text="${ct.maxCourses}">0</td>
            <td th:text="${ct.minCredits}">0</td>
            <td th:text="${ct.maxCredits}">0</td>
            <td>
    <span th:if="${ct.splid} == ${splid}">
        <div class="d-flex gap-1">
            <a th:href="@{/admin/programs/{programId}/schemes/{schemeId}/{splid}/course-types/{ctpcode}/edit(programId=${programId}, schemeId=${scheme.id}, splid=${splid}, ctpcode=${ct.ctpcode})}"
               class="btn btn-sm btn-primary">Edit</a>

            <a th:href="@{/admin/programs/{programId}/schemes/{schemeId}/{splid}/course-types/{ctpcode}/delete(programId=${programId}, schemeId=${scheme.id}, splid=${splid}, ctpcode=${ct.ctpcode})}"
               class="btn btn-sm btn-danger">Delete</a>
        </div>
    </span>

                <span th:unless="${ct.splid} == ${splid}">
        <div class="d-flex gap-1">
            <button class="btn btn-sm btn-outline-secondary"
                    onclick="alert('This course type belongs to the general degree; update it from the general degree page.');">
                Edit
            </button>

            <button class="btn btn-sm btn-outline-secondary"
                    onclick="alert('This course type belongs to the general degree; update it from the general degree page.');">
                Delete
            </button>
        </div>
    </span>
            </td>

        </tr>
        </tbody>
    </table>

    <div class="d-flex mt-3 gap-2">
        <a class="btn btn-success" th:href="@{/admin/programs/{programId}/schemes/{schemeId}/{splid}/course-types/add(programId=${programId}, schemeId=${scheme.id}, splid=${splid})}">Add Course Type</a>
        <div class="ms-auto">
            <a class="btn btn-secondary" th:href="@{/admin/programs/{programId}/schemes/{schemeId}(programId=${programId}, schemeId=${scheme.id})}">‚Üê Back to Scheme</a>
        </div>
    </div>

    <!-- FOOTER -->
    <div th:replace="fragments/footer :: footer"></div>
</div>

<script>
    setTimeout(() => {
        const alertElement = document.getElementById('flashMessage');
        if (alertElement) {
            const alert = bootstrap.Alert.getOrCreateInstance(alertElement);
            alert.close();  // Properly removes it
        }
    }, 5000);
</script>

</body>
</html>
